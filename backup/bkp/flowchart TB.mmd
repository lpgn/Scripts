flowchart TB
    Start([ğŸ”Œ Easy USB Manager<br/>PowerShell Script]) --> AdminCheck{Administrator<br/>Check}
    AdminCheck -->|Warning if not admin| EnumDevices[ğŸ“‹ Enumerate USB Devices<br/>via 'usbipd list']
    
    EnumDevices --> ParseDevices[ğŸ” Parse Device Data<br/>BUSID, VID:PID, Description, State]
    ParseDevices --> MainMenu[ğŸ¯ Arrow-Key Navigation Menu<br/>Select USB Device]
    
    MainMenu --> DeviceActions{Device Actions Menu}
    
    DeviceActions -->|Option 1| AttachDetach{Device State?}
    AttachDetach -->|Not Attached| Attach[âš¡ Attach Device<br/>usbipd attach --busid]
    AttachDetach -->|Attached| Detach[ğŸ”Œ Detach Device<br/>usbipd detach --busid]
    
    DeviceActions -->|Option 2| Setup[ğŸ› ï¸ Linux Device Setup<br/>Only if attached]
    
    Setup --> LoadDrivers[ğŸ“¦ Load USB Serial Drivers<br/>modprobe ftdi_sio/cp210x/ch341]
    LoadDrivers --> GroupCheck[ğŸ‘¥ Check/Add dialout Group<br/>usermod -a -G dialout $USER]
    GroupCheck --> FindDevice[ğŸ” Find Device Node<br/>Scan /dev/ttyUSB* /dev/ttyACM*]
    FindDevice --> SetPermissions[ğŸ” Set Permissions<br/>chmod 666 /dev/ttyUSB0]
    SetPermissions --> ShowKernel[ğŸ“œ Show Recent dmesg<br/>USB/serial messages]
    
    ShowKernel --> Continue[â¸ï¸ Press any key to continue]
    Attach --> Continue
    Detach --> Continue
    
    Continue --> MainMenu
    MainMenu -->|ESC/Q| Exit([ğŸ‘‹ Exit Script])
    
    style Start fill:#e1f5fe
    style AdminCheck fill:#fff3e0
    style MainMenu fill:#f3e5f5
    style DeviceActions fill:#e8f5e8
    style Setup fill:#fff8e1
    style Exit fill:#ffebee